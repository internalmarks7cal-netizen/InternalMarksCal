<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <title>Internal Marks Calculator</title>
  <meta name="description" content="Simple, mobile-friendly internal marks calculator with detailed breakdown." />
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-XFYY4YVQS7"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'G-XFYY4YVQS7');
  </script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0f1724;
      --card:#111a2b;
      --muted:#94a3b8;
      --accent:#60a5fa;
      --accent2:#7c3aed;
      --success:#16a34a;
      --danger:#ef4444;
      --radius:14px;
    }
    *{box-sizing:border-box;}
    body{
      margin:0;
      font-family:'Poppins',sans-serif;
      background:linear-gradient(180deg,var(--bg) 0%,#091529 100%);
      color:#f1f5f9;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      min-height:100vh;
      padding:16px;
    }
    .wrapper{
      width:100%;
      max-width:420px;
      background:var(--card);
      border-radius:var(--radius);
      padding:20px;
      box-shadow:0 4px 18px rgba(0,0,0,0.3);
    }
    h1{
      text-align:center;
      font-size:20px;
      margin-bottom:6px;
    }
    p.lead{
      text-align:center;
      color:var(--muted);
      font-size:13px;
      margin-bottom:18px;
    }
    label{display:block;font-size:13px;margin-bottom:4px;color:var(--muted);}
    input{
      width:100%;
      padding:10px 12px;
      margin-bottom:14px;
      border-radius:10px;
      border:1px solid rgba(255,255,255,0.05);
      background:rgba(255,255,255,0.05);
      color:white;
      font-size:15px;
    }
    button{
      width:100%;
      padding:12px;
      border:none;
      border-radius:10px;
      font-size:16px;
      font-weight:600;
      margin-top:6px;
    }
    .btn-primary{background:linear-gradient(90deg,var(--accent),var(--accent2));color:#fff;}
    .btn-secondary{background:transparent;border:1px solid rgba(255,255,255,0.1);color:var(--muted);}

    #result{
      margin-top:18px;
      background:rgba(255,255,255,0.04);
      padding:14px;
      border-radius:10px;
      font-size:14px;
    }
    #result strong{color:var(--accent);}
    .breakdown{
      margin-top:10px;
      padding:10px;
      background:rgba(255,255,255,0.06);
      border-radius:10px;
      font-size:13px;
      color:var(--muted);
    }
    @media(max-width:480px){
      h1{font-size:18px;}
      body{padding:10px;}
    }
  </style>
</head>
<body>
  <div class="wrapper">
    <h1>Internal Marks Calculator</h1>
    <p class="lead">Quick mobile version with full internal calculation details</p>

    <label for="aat1">AAT 1 (0–10)</label>
    <input id="aat1" type="number" min="0" max="10" step="0.1" placeholder="Enter AAT1">

    <label for="aat2">AAT 2 (0–10)</label>
    <input id="aat2" type="number" min="0" max="10" step="0.1" placeholder="Enter AAT2">

    <label for="mid1">Mid 1 (0–30)</label>
    <input id="mid1" type="number" min="0" max="30" step="0.5" placeholder="Enter Mid1">

    <label for="mid2">Mid 2 (0–30)</label>
    <input id="mid2" type="number" min="0" max="30" step="0.5" placeholder="Enter Mid2">

    <label for="per">Attendance % (1–100)</label>
    <input id="per" type="number" min="0" max="100" step="0.1" placeholder="Enter Attendance %">

    <button class="btn-primary" onclick="calculate()">Calculate</button>
    <button class="btn-secondary" onclick="resetForm()">Reset</button>

    <div id="result">Your result will appear here.</div>
  </div>

  <script>
    function calculate(){
      const aat1=parseFloat(document.getElementById('aat1').value);
      const aat2=parseFloat(document.getElementById('aat2').value);
      const mid1=parseFloat(document.getElementById('mid1').value);
      const mid2=parseFloat(document.getElementById('mid2').value);
      const per=parseFloat(document.getElementById('per').value);
      const result=document.getElementById('result');

      if(isNaN(aat1)||aat1<0||aat1>10||isNaN(aat2)||aat2<0||aat2>10||isNaN(mid1)||mid1<0||mid1>30||isNaN(mid2)||mid2<0||mid2>30||isNaN(per)||per<0||per>100){
        result.innerHTML='<span style="color:var(--danger)">❌ Invalid inputs</span>';
        // Note: We don't track invalid calculations in GA4
        return;
      }

      const avgAAT=(aat1+aat2)/2;
      const aatMarks=(avgAAT/10)*15;
      const bestMid=Math.max(mid1,mid2);
      const otherMid=Math.min(mid1,mid2);
      const midWeight=(bestMid*0.75+otherMid*0.25);
      const midWeighted=(midWeight/30)*20;

      let attendanceBonus=0;
      let condonationMsg="";
      let notQualified=false;

      if(per>=90)attendanceBonus=5;
      else if(per>=85)attendanceBonus=4;
      else if(per>=80)attendanceBonus=3;
      else if(per>=75)attendanceBonus=2;
      else if(per>=65){attendanceBonus=0;condonationMsg='⚠️ Condonation Fee ₹500 Required';}
      else{attendanceBonus=0;notQualified=true;}

      const totalMarks=aatMarks+midWeighted+attendanceBonus;
      let output=`<strong>Total Internal Marks (out of 40): ${totalMarks.toFixed(2)}</strong><br>`;

      if(notQualified)output+='<span style="color:var(--danger)">❌ Not Qualified: Attendance below 65%</span>';
      else if(totalMarks>=21)output+='<span style="color:var(--success)">✅ Qualified: You can write the semester exam</span>';
      else output+='<span style="color:var(--danger)">❌ Not Qualified: Marks below 21</span>';

      if(condonationMsg)output+=`<br><span style="color:orange">${condonationMsg}</span>`;

      output+=`<div class='breakdown'>
        <div><strong>Average AAT:</strong> (${aat1}+${aat2})/2 = ${avgAAT.toFixed(2)}</div>
        <div><strong>AAT Marks:</strong> (${avgAAT.toFixed(2)}/10) × 15 = ${aatMarks.toFixed(2)}</div>
        <div><strong>Mid Weighted:</strong> Best ${bestMid} × 0.75 + Other ${otherMid} × 0.25 = ${midWeight.toFixed(2)}</div>
        <div><strong>Mid Marks:</strong> (${midWeight.toFixed(2)}/30) × 20 = ${midWeighted.toFixed(2)}</div>
        <div><strong>Attendance Bonus:</strong> ${attendanceBonus.toFixed(2)}</div>
        <div><strong>Final Total:</strong> ${aatMarks.toFixed(2)} + ${midWeighted.toFixed(2)} + ${attendanceBonus.toFixed(2)} = ${totalMarks.toFixed(2)}</div>
      </div>`;

      result.innerHTML=output;

      // --- GA4 Custom Event Tracking Added Here ---
      if (typeof gtag === 'function') {
        gtag('event', 'calculate_marks', {
          'aat_score_avg': parseFloat(avgAAT.toFixed(2)),
          'mid_score_weighted': parseFloat(midWeighted.toFixed(2)),
          'attendance_percentage': per,
          'final_internal_score': parseFloat(totalMarks.toFixed(2)),
          'is_qualified': totalMarks >= 21 && per >= 65 // Custom dimension for easy filtering in GA4
        });
      }
      // ------------------------------------------
    }

    function resetForm(){
      document.querySelectorAll('input').forEach(i=>i.value='');
      document.getElementById('result').textContent='Your result will appear here.';
      // Optionally track reset event in GA4
      if (typeof gtag === 'function') {
        gtag('event', 'form_reset');
      }
    }
  </script>
</body>
</html>
